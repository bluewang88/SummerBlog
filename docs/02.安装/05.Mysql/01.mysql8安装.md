---
title: mysql8安装
date: 2020-10-17 17:29:19
permalink: /pages/7a784f/
categories:
  - 安装
  - Mysql
tags:
  - mysql
---
## 此次安装基于docker


### 第一步 下拉镜像
`docker pull mysql:8.0.21`
![](https://cdn.jsdelivr.net/gh/summerking1/image@main/75.png)


### 第二步 启动镜像
`docker run -p 3307:3306 --name mysql -e MYSQL_ROOT_PASSWORD=hadoop -d mysql:8.0.21`

### 第三步 启动成功后，进入容器内部拷贝配置文件，到宿主主机
`docker cp  mysql:/etc/mysql /home/summer/mysql8`

`拷贝容器的 /etc/mysql目录到 主机目录/home/summer/mysql8`
### 第四步 删除mysql容器，重新创建容器
`docker stop mysql`
`docker rm mysql`

### 第五步 启动mysql ，挂载配置文件，数据持久化到宿主主机
启动脚本 文件名为mysql8.0.21.sh
```shell
#!/bin/sh
docker run \
-p 3307:3306 \
--name mysql \
--privileged=true \
--restart unless-stopped \
-v /home/summer/mysql8/mysql:/etc/mysql \
-v /home/summer/mysql8/logs:/logs \
-v /home/summer/mysql8/data:/var/lib/mysql \
-v /etc/localtime:/etc/localtime \
-e MYSQL_ROOT_PASSWORD=hadoop \
-d mysql:8.0.21
```
>命令解释：
 -p 端口映射
--privileged=true  挂载文件权限设置
--restart unless-stopped  设置 开机后自动重启容器
-v /home/summer/mysql8/mysql:/etc/mysql    挂载配置文件
-v /home/summer/mysql8/logs:/logs \      挂载日志
-v /home/summer/mysql8/data:/var/lib/mysql \  挂载数据文件 持久化到主机，
-v /etc/localtime:/etc/localtime    容器时间与宿主机同步
-e MYSQL_ROOT_PASSWORD=hadoop    设置密码
-d  mysql:8.0.21   后台启动,mysql
### 第六步，执行脚本 启动镜像

大功告成----挂载出来的数据文件以及配置文件
![](https://cdn.jsdelivr.net/gh/summerking1/image@main/76.png)
![](https://cdn.jsdelivr.net/gh/summerking1/image@main/77.png)

```shell
ALTER USER "root"@"localhost" IDENTIFIED BY "hadoop";
FLUSH PRIVILEGES;
create user summer@'%' identified  by '123456';
grant all privileges on *.* to summer@'%' with grant option;
exit;
use mysql;
update user set host = '%' where user ='summer'; 
ALTER USER 'summer'@'%' IDENTIFIED BY 'password' PASSWORD EXPIRE NEVER;
ALTER USER 'summer'@'%' IDENTIFIED WITH mysql_native_password BY '123456';
exit;
```